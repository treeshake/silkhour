(()=>{"use strict";let t={};function i(i,n){return void 0===t[i]&&(t[i]=[]),t[i]=[...t[i],n],function(){t[i]=t[i].filter((t=>t!==n))}}class n extends HTMLElement{constructor(){super(),this.quantityForm=null,this.cartUpdateUnsubscriber=void 0,this.variantChangeUnsubscriber=void 0,this.input=this.querySelector(".quantity__input"),this.currentVariant=this.querySelector(".product-variant-id"),this.submitButton=this.querySelector('[type="submit"]')}connectedCallback(){console.log("Connected callback"),this.input&&(this.quantityForm=this.querySelector(".product-form__quantity"),this.quantityForm&&(this.setQuantityBoundries(),this.dataset.originalSection||(this.cartUpdateUnsubscriber=i("cart-update",this.fetchQuantityRules.bind(this))),this.variantChangeUnsubscriber=i("variant-change",(t=>{const i=this.dataset.originalSection?this.dataset.originalSection:this.dataset.section;t.data.sectionId===i&&(this.updateQuantityRules(t.data.sectionId,t.data.html),this.setQuantityBoundries())}))))}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber(),this.variantChangeUnsubscriber&&this.variantChangeUnsubscriber()}setQuantityBoundries(){var i,n,e,a,s;const r={cartQuantity:(null===(i=this.input)||void 0===i?void 0:i.dataset.cartQuantity)?parseInt(this.input.dataset.cartQuantity):0,min:(null===(n=this.input)||void 0===n?void 0:n.dataset.min)?parseInt(this.input.dataset.min):1,max:(null===(e=this.input)||void 0===e?void 0:e.dataset.max)?parseInt(this.input.dataset.max):null,step:(null===(a=this.input)||void 0===a?void 0:a.step)?parseInt(this.input.step):1};let u=r.min;const o=null===r.max?r.max:r.max-r.cartQuantity;var c;null!==o&&(u=Math.min(u,o)),r.cartQuantity>=r.min&&(u=Math.min(u,r.step)),this.input.min=u,o?this.input.max=o:null===(s=this.input)||void 0===s||s.removeAttribute("max"),this.input.value=u,t[c="quantity-update"]&&t[c].forEach((t=>{t(void 0)}))}fetchQuantityRules(){var t;this.currentVariant&&this.currentVariant.value&&(null===(t=this.querySelector(".quantity__rules-cart .loading__spinner"))||void 0===t||t.classList.remove("hidden"),fetch(`${this.dataset.url}?variant=${this.currentVariant.value}&section_id=${this.dataset.section}`).then((t=>t.text())).then((t=>{const i=(new DOMParser).parseFromString(t,"text/html");this.updateQuantityRules(this.dataset.section,i),this.setQuantityBoundries()})).catch((t=>{console.error(t)})).finally((()=>{var t;null===(t=this.querySelector(".quantity__rules-cart .loading__spinner"))||void 0===t||t.classList.add("hidden")})))}updateQuantityRules(t,i){var n;const e=i.getElementById(`Quantity-Form-${t}`),a=[".quantity__input",".quantity__rules",".quantity__label"];for(let t of a){const i=null===(n=this.quantityForm)||void 0===n?void 0:n.querySelector(t),a=e.querySelector(t);if(i&&a)if(".quantity__input"===t){const t=["data-cart-quantity","data-min","data-max","step"];for(let n of t){const t=a.getAttribute(n);null!==t?i.setAttribute(n,t):i.removeAttribute(n)}}else i.innerHTML=a.innerHTML}}}customElements.get("custom-product-info")||customElements.define("custom-product-info",n),console.log(customElements)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LG9CQUFvQjNCLEtBQUtTLFFBQVFNLFdBRW5Ga0IsTUFBTUMsR0FDRUEsRUFBU0MsU0FFakJGLE1BQU1HLElBQ0wsTUFBTWxCLEdBQU8sSUFBSW1CLFdBQVlDLGdCQUFnQkYsRUFBYyxhQUMzRHBDLEtBQUtpQixvQkFBb0JqQixLQUFLUyxRQUFRTSxRQUFTRyxHQUMvQ2xCLEtBQUtRLHNCQUFzQixJQUU1QitCLE9BQU9DLElBQ05sQyxRQUFRbUMsTUFBTUQsRUFBRSxJQUVqQkUsU0FBUSxLLE1BR04sUUFGRCxFQUFBMUMsS0FBS0UsY0FDSCxrREFDRCxTQUFFMkIsVUFBVWMsSUFBSSxTQUFTLElBRWhDLENBRUEsbUJBQUExQixDQUFvQkgsRUFBZ0JJLEcsTUFDbEMsTUFBTTBCLEVBQXNCMUIsRUFBSzJCLGVBQy9CLGlCQUFpQi9CLEtBRWJnQyxFQUFZLENBQ2hCLG1CQUNBLG1CQUNBLG9CQUVGLElBQUssSUFBSUMsS0FBWUQsRUFBVyxDQUM5QixNQUFNRSxFQUEyQixRQUFqQixFQUFBaEQsS0FBS0gsb0JBQVksZUFBRUssY0FBYzZDLEdBQzNDRSxFQUFVTCxFQUFvQjFDLGNBQWM2QyxHQUNsRCxHQUFLQyxHQUFZQyxFQUNqQixHQUFpQixxQkFBYkYsRUFBaUMsQ0FDbkMsTUFBTUcsRUFBYSxDQUNqQixxQkFDQSxXQUNBLFdBQ0EsUUFFRixJQUFLLElBQUlDLEtBQWFELEVBQVksQ0FDaEMsTUFBTUUsRUFBZUgsRUFBUUksYUFBYUYsR0FDckIsT0FBakJDLEVBQ0ZKLEVBQVFNLGFBQWFILEVBQVdDLEdBRWhDSixFQUFRdEIsZ0JBQWdCeUIsRUFFNUIsQ0FDRixNQUNFSCxFQUFRTyxVQUFZTixFQUFRTSxTQUVoQyxDQUNGLEVFeElLQyxlQUFlQyxJQUFJLHdCQUN0QkQsZUFBZUUsT0FBTyxzQkFBdUJqRSxHQUUvQ2EsUUFBUUMsSUFBSWlELGUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sYWItY29uY2llcmdlLy4vc3JjL3RzL3B1YnN1Yi50cyIsIndlYnBhY2s6Ly9sYWItY29uY2llcmdlLy4vc3JjL3RzL3Byb2R1Y3QtaW5mby50cyIsIndlYnBhY2s6Ly9sYWItY29uY2llcmdlLy4vc3JjL3RzL2NvbnN0YW50cy50cyIsIndlYnBhY2s6Ly9sYWItY29uY2llcmdlLy4vc3JjL3RzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29waWVkIGFuZCBhZGFwdGVkIGZyb20gU3BvdGxpZ2h0IFxuICogQHNlZSBwdWJzdWIuanNcbioqLyBcblxubGV0IHN1YnNjcmliZXJzOiBhbnkgPSB7fTtcblxuZXhwb3J0IGZ1bmN0aW9uIHN1YnNjcmliZShcbiAgZXZlbnROYW1lOiBzdHJpbmcsXG4gIGNhbGxiYWNrOiAoZGF0YTogdW5rbm93bikgPT4gdm9pZCxcbikge1xuICBpZiAoc3Vic2NyaWJlcnNbZXZlbnROYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgc3Vic2NyaWJlcnNbZXZlbnROYW1lXSA9IFtdO1xuICB9XG5cbiAgc3Vic2NyaWJlcnNbZXZlbnROYW1lXSA9IFsuLi5zdWJzY3JpYmVyc1tldmVudE5hbWVdLCBjYWxsYmFja107XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIHVuc3Vic2NyaWJlKCkge1xuICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0gPSBzdWJzY3JpYmVyc1tldmVudE5hbWVdLmZpbHRlcigoY2I6IGFueSkgPT4ge1xuICAgICAgcmV0dXJuIGNiICE9PSBjYWxsYmFjaztcbiAgICB9KTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2goZXZlbnROYW1lOiBzdHJpbmcsIGRhdGE6IHVua25vd24pIHtcbiAgaWYgKHN1YnNjcmliZXJzW2V2ZW50TmFtZV0pIHtcbiAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdLmZvckVhY2goKGNhbGxiYWNrOiAoZGF0YTogYW55KSA9PiB2b2lkKSA9PiB7XG4gICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUFVCX1NVQl9FVkVOVFMgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBwdWJsaXNoLCBzdWJzY3JpYmUgfSBmcm9tICcuL3B1YnN1Yic7XG5cbi8qKlxuICogQ29waWVkIGFuZCBhZGFwdGVkIGZyb20gU3BvdGxpZ2h0IFxuICogQHNlZSBwcm9kdWN0LWluZm8uanNcbioqLyBcbmV4cG9ydCBjbGFzcyBQcm9kdWN0SW5mbyBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgaW5wdXQ6IEhUTUxGb3JtRWxlbWVudCB8IG51bGw7XG4gIGN1cnJlbnRWYXJpYW50OiBIVE1MRm9ybUVsZW1lbnQgfCBudWxsO1xuICBzdWJtaXRCdXR0b246IEhUTUxGb3JtRWxlbWVudCB8IG51bGw7XG4gIHF1YW50aXR5Rm9ybTogSFRNTEZvcm1FbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmlucHV0ID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcucXVhbnRpdHlfX2lucHV0Jyk7XG4gICAgdGhpcy5jdXJyZW50VmFyaWFudCA9IHRoaXMucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtdmFyaWFudC1pZCcpO1xuICAgIHRoaXMuc3VibWl0QnV0dG9uID0gdGhpcy5xdWVyeVNlbGVjdG9yKCdbdHlwZT1cInN1Ym1pdFwiXScpO1xuICB9XG5cbiAgY2FydFVwZGF0ZVVuc3Vic2NyaWJlcj86ICgpID0+IHZvaWQgPSB1bmRlZmluZWQ7XG4gIHZhcmlhbnRDaGFuZ2VVbnN1YnNjcmliZXI/OiAoKSA9PiB2b2lkID0gdW5kZWZpbmVkO1xuXG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGNvbnNvbGUubG9nKGBDb25uZWN0ZWQgY2FsbGJhY2tgKTtcbiAgICBpZiAoIXRoaXMuaW5wdXQpIHJldHVybjtcbiAgICB0aGlzLnF1YW50aXR5Rm9ybSA9IHRoaXMucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtZm9ybV9fcXVhbnRpdHknKTtcbiAgICBpZiAoIXRoaXMucXVhbnRpdHlGb3JtKSByZXR1cm47XG4gICAgdGhpcy5zZXRRdWFudGl0eUJvdW5kcmllcygpO1xuICAgIGlmICghdGhpcy5kYXRhc2V0Lm9yaWdpbmFsU2VjdGlvbikge1xuICAgICAgdGhpcy5jYXJ0VXBkYXRlVW5zdWJzY3JpYmVyID0gc3Vic2NyaWJlKFxuICAgICAgICBQVUJfU1VCX0VWRU5UUy5jYXJ0VXBkYXRlLFxuICAgICAgICB0aGlzLmZldGNoUXVhbnRpdHlSdWxlcy5iaW5kKHRoaXMpLFxuICAgICAgKTtcbiAgICB9XG4gICAgdGhpcy52YXJpYW50Q2hhbmdlVW5zdWJzY3JpYmVyID0gc3Vic2NyaWJlKFxuICAgICAgUFVCX1NVQl9FVkVOVFMudmFyaWFudENoYW5nZSxcbiAgICAgIChldmVudDogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlY3Rpb25JZCA9IHRoaXMuZGF0YXNldC5vcmlnaW5hbFNlY3Rpb25cbiAgICAgICAgICA/IHRoaXMuZGF0YXNldC5vcmlnaW5hbFNlY3Rpb25cbiAgICAgICAgICA6IHRoaXMuZGF0YXNldC5zZWN0aW9uO1xuICAgICAgICBpZiAoZXZlbnQuZGF0YS5zZWN0aW9uSWQgIT09IHNlY3Rpb25JZCkgcmV0dXJuO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1YW50aXR5UnVsZXMoZXZlbnQuZGF0YS5zZWN0aW9uSWQsIGV2ZW50LmRhdGEuaHRtbCk7XG4gICAgICAgIHRoaXMuc2V0UXVhbnRpdHlCb3VuZHJpZXMoKTtcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGlmICh0aGlzLmNhcnRVcGRhdGVVbnN1YnNjcmliZXIpIHtcbiAgICAgIHRoaXMuY2FydFVwZGF0ZVVuc3Vic2NyaWJlcigpO1xuICAgIH1cbiAgICBpZiAodGhpcy52YXJpYW50Q2hhbmdlVW5zdWJzY3JpYmVyKSB7XG4gICAgICB0aGlzLnZhcmlhbnRDaGFuZ2VVbnN1YnNjcmliZXIoKTtcbiAgICB9XG4gIH1cblxuICBzZXRRdWFudGl0eUJvdW5kcmllcygpIHtcbiAgICBjb25zdCBkYXRhID0ge1xuICAgICAgY2FydFF1YW50aXR5OiB0aGlzLmlucHV0Py5kYXRhc2V0LmNhcnRRdWFudGl0eVxuICAgICAgICA/IHBhcnNlSW50KHRoaXMuaW5wdXQuZGF0YXNldC5jYXJ0UXVhbnRpdHkpXG4gICAgICAgIDogMCxcbiAgICAgIG1pbjogdGhpcy5pbnB1dD8uZGF0YXNldC5taW4gPyBwYXJzZUludCh0aGlzLmlucHV0LmRhdGFzZXQubWluKSA6IDEsXG4gICAgICBtYXg6IHRoaXMuaW5wdXQ/LmRhdGFzZXQubWF4ID8gcGFyc2VJbnQodGhpcy5pbnB1dC5kYXRhc2V0Lm1heCkgOiBudWxsLFxuICAgICAgc3RlcDogdGhpcy5pbnB1dD8uc3RlcCA/IHBhcnNlSW50KHRoaXMuaW5wdXQuc3RlcCkgOiAxLFxuICAgIH07XG5cbiAgICBsZXQgbWluID0gZGF0YS5taW47XG4gICAgY29uc3QgbWF4ID0gZGF0YS5tYXggPT09IG51bGwgPyBkYXRhLm1heCA6IGRhdGEubWF4IC0gZGF0YS5jYXJ0UXVhbnRpdHk7XG4gICAgaWYgKG1heCAhPT0gbnVsbCkgbWluID0gTWF0aC5taW4obWluLCBtYXgpO1xuICAgIGlmIChkYXRhLmNhcnRRdWFudGl0eSA+PSBkYXRhLm1pbikgbWluID0gTWF0aC5taW4obWluLCBkYXRhLnN0ZXApO1xuICAgIHRoaXMuaW5wdXQhLm1pbiA9IG1pbjtcblxuICAgIGlmIChtYXgpIHtcbiAgICAgIHRoaXMuaW5wdXQhLm1heCA9IG1heDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5pbnB1dD8ucmVtb3ZlQXR0cmlidXRlKCdtYXgnKTtcbiAgICB9XG4gICAgdGhpcy5pbnB1dCEudmFsdWUgPSBtaW47XG4gICAgcHVibGlzaChQVUJfU1VCX0VWRU5UUy5xdWFudGl0eVVwZGF0ZSwgdW5kZWZpbmVkKTtcbiAgfVxuXG4gIGZldGNoUXVhbnRpdHlSdWxlcygpIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhbnQgfHwgIXRoaXMuY3VycmVudFZhcmlhbnQudmFsdWUpIHJldHVybjtcbiAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAnLnF1YW50aXR5X19ydWxlcy1jYXJ0IC5sb2FkaW5nX19zcGlubmVyJyxcbiAgICApPy5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICBmZXRjaChcbiAgICAgIGAke3RoaXMuZGF0YXNldC51cmx9P3ZhcmlhbnQ9JHt0aGlzLmN1cnJlbnRWYXJpYW50LnZhbHVlfSZzZWN0aW9uX2lkPSR7dGhpcy5kYXRhc2V0LnNlY3Rpb259YCxcbiAgICApXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigocmVzcG9uc2VUZXh0KSA9PiB7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHJlc3BvbnNlVGV4dCwgJ3RleHQvaHRtbCcpO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1YW50aXR5UnVsZXModGhpcy5kYXRhc2V0LnNlY3Rpb24sIGh0bWwpO1xuICAgICAgICB0aGlzLnNldFF1YW50aXR5Qm91bmRyaWVzKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgJy5xdWFudGl0eV9fcnVsZXMtY2FydCAubG9hZGluZ19fc3Bpbm5lcicsXG4gICAgICAgICk/LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgICAgfSk7XG4gIH1cblxuICB1cGRhdGVRdWFudGl0eVJ1bGVzKHNlY3Rpb25JZDogYW55LCBodG1sOiBhbnkpIHtcbiAgICBjb25zdCBxdWFudGl0eUZvcm1VcGRhdGVkID0gaHRtbC5nZXRFbGVtZW50QnlJZChcbiAgICAgIGBRdWFudGl0eS1Gb3JtLSR7c2VjdGlvbklkfWAsXG4gICAgKTtcbiAgICBjb25zdCBzZWxlY3RvcnMgPSBbXG4gICAgICAnLnF1YW50aXR5X19pbnB1dCcsXG4gICAgICAnLnF1YW50aXR5X19ydWxlcycsXG4gICAgICAnLnF1YW50aXR5X19sYWJlbCcsXG4gICAgXTtcbiAgICBmb3IgKGxldCBzZWxlY3RvciBvZiBzZWxlY3RvcnMpIHtcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnF1YW50aXR5Rm9ybT8ucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgICBjb25zdCB1cGRhdGVkID0gcXVhbnRpdHlGb3JtVXBkYXRlZC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgIGlmICghY3VycmVudCB8fCAhdXBkYXRlZCkgY29udGludWU7XG4gICAgICBpZiAoc2VsZWN0b3IgPT09ICcucXVhbnRpdHlfX2lucHV0Jykge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gW1xuICAgICAgICAgICdkYXRhLWNhcnQtcXVhbnRpdHknLFxuICAgICAgICAgICdkYXRhLW1pbicsXG4gICAgICAgICAgJ2RhdGEtbWF4JyxcbiAgICAgICAgICAnc3RlcCcsXG4gICAgICAgIF07XG4gICAgICAgIGZvciAobGV0IGF0dHJpYnV0ZSBvZiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgY29uc3QgdmFsdWVVcGRhdGVkID0gdXBkYXRlZC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgICAgICBpZiAodmFsdWVVcGRhdGVkICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjdXJyZW50LnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlVXBkYXRlZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnQucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50LmlubmVySFRNTCA9IHVwZGF0ZWQuaW5uZXJIVE1MO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBDb3BpZWQgYW5kIGFkYXB0ZWQgZnJvbSBTcG90bGlnaHRcbiAqIEBzZWUgY29uc3RhbnRzLmpzXG4gKi9cbmV4cG9ydCBjb25zdCBPTl9DSEFOR0VfREVCT1VOQ0VfVElNRVIgPSAzMDA7XG5cbmV4cG9ydCBjb25zdCBQVUJfU1VCX0VWRU5UUyA9IHtcbiAgY2FydFVwZGF0ZTogJ2NhcnQtdXBkYXRlJyxcbiAgcXVhbnRpdHlVcGRhdGU6ICdxdWFudGl0eS11cGRhdGUnLFxuICB2YXJpYW50Q2hhbmdlOiAndmFyaWFudC1jaGFuZ2UnLFxuICBjYXJ0RXJyb3I6ICdjYXJ0LWVycm9yJyxcbn07XG4iLCJpbXBvcnQgeyBQcm9kdWN0SW5mbyB9IGZyb20gJy4vcHJvZHVjdC1pbmZvJztcblxuXG5mdW5jdGlvbiBtYWluKCkge1xuICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCgnY3VzdG9tLXByb2R1Y3QtaW5mbycpKSB7XG4gICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdjdXN0b20tcHJvZHVjdC1pbmZvJywgUHJvZHVjdEluZm8pO1xuICB9XG4gIGNvbnNvbGUubG9nKGN1c3RvbUVsZW1lbnRzKTtcbn1cblxubWFpbigpOyJdLCJuYW1lcyI6WyJzdWJzY3JpYmVycyIsInN1YnNjcmliZSIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwidW5kZWZpbmVkIiwiZmlsdGVyIiwiY2IiLCJQcm9kdWN0SW5mbyIsIkhUTUxFbGVtZW50IiwiY29uc3RydWN0b3IiLCJzdXBlciIsInF1YW50aXR5Rm9ybSIsImNhcnRVcGRhdGVVbnN1YnNjcmliZXIiLCJ2YXJpYW50Q2hhbmdlVW5zdWJzY3JpYmVyIiwidGhpcyIsImlucHV0IiwicXVlcnlTZWxlY3RvciIsImN1cnJlbnRWYXJpYW50Iiwic3VibWl0QnV0dG9uIiwiY29ubmVjdGVkQ2FsbGJhY2siLCJjb25zb2xlIiwibG9nIiwic2V0UXVhbnRpdHlCb3VuZHJpZXMiLCJkYXRhc2V0Iiwib3JpZ2luYWxTZWN0aW9uIiwiZmV0Y2hRdWFudGl0eVJ1bGVzIiwiYmluZCIsImV2ZW50Iiwic2VjdGlvbklkIiwic2VjdGlvbiIsImRhdGEiLCJ1cGRhdGVRdWFudGl0eVJ1bGVzIiwiaHRtbCIsImRpc2Nvbm5lY3RlZENhbGxiYWNrIiwiY2FydFF1YW50aXR5IiwicGFyc2VJbnQiLCJtaW4iLCJtYXgiLCJzdGVwIiwiTWF0aCIsInJlbW92ZUF0dHJpYnV0ZSIsInZhbHVlIiwiZm9yRWFjaCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImZldGNoIiwidXJsIiwidGhlbiIsInJlc3BvbnNlIiwidGV4dCIsInJlc3BvbnNlVGV4dCIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsImNhdGNoIiwiZSIsImVycm9yIiwiZmluYWxseSIsImFkZCIsInF1YW50aXR5Rm9ybVVwZGF0ZWQiLCJnZXRFbGVtZW50QnlJZCIsInNlbGVjdG9ycyIsInNlbGVjdG9yIiwiY3VycmVudCIsInVwZGF0ZWQiLCJhdHRyaWJ1dGVzIiwiYXR0cmlidXRlIiwidmFsdWVVcGRhdGVkIiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwiaW5uZXJIVE1MIiwiY3VzdG9tRWxlbWVudHMiLCJnZXQiLCJkZWZpbmUiXSwic291cmNlUm9vdCI6IiJ9